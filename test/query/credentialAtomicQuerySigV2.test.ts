import {describe} from "mocha";

const path = require("path");
const wasmTester = require("circom_tester").wasm;

export {};

describe("Test credentialAtomicQuerySigV2.circom", function() {

    this.timeout(600000);

    let circuit;

    before(async () => {
        circuit = await wasmTester(
            path.join(__dirname, "../../circuits/offchain", "credentialAtomicQuerySigV2.circom"),
            {
                output: path.join(__dirname, "circuits", "build"),
                recompile: true,
                reduceConstraints: false,
            },
        );

    });

    after(async () => {
        circuit.release()
    })

    it("UserID subject. UserID out. Zero nonce. claim issued on userID", async () => {
        const inputs = {
            userGenesisID: "24357338057394103910029868244681596615276666879950910837900400354886746113",
            nonce: "0",
            claimSubjectProfileNonce: "0",
            issuerID: "24357338057394103910029868244681596615276666879950910837900400354886746113",
            issuerClaim: [
                "3583233690122716044519380227940806650830",
                "24357338057394103910029868244681596615276666879950910837900400354886746113",
                "17568057213828477233507447080689055308823020388972334380526849356111335110900",
                "0",
                "30803922965249841627828060170",
                "0",
                "0",
                "0",
            ],
            issuerClaimNonRevClaimsTreeRoot: "16935233905999379395228879484629933212061337894505747058350106225580401780334",
            issuerClaimNonRevRevTreeRoot: "0",
            issuerClaimNonRevRootsTreeRoot: "0",
            issuerClaimNonRevState: "18038855432424775233659896904370825175764119936950028950189276486279006981491",
            issuerClaimNonRevMtp: [
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
            ],
            issuerClaimNonRevMtpAuxHi: "0",
            issuerClaimNonRevMtpAuxHv: "0",
            issuerClaimNonRevMtpNoAux: "1",
            claimSchema: "180410020913331409885634153623124536270",
            issuerClaimSignatureR8x: "3017397964988671065300729044646157787094963425063948585835659398590899755539",
            issuerClaimSignatureR8y: "8933147283525203493792096378411252775992322346613402903323345179819059106328",
            issuerClaimSignatureS: "2328449226267223092529649688730159507357166811782711131160124115135840509586",
            issuerAuthClaim: [
                "304427537360709784173770334266246861770",
                "0",
                "4720763745722683616702324599137259461509439547324750011830105416383780791263",
                "4844030361230692908091131578688419341633213823133966379083981236400104720538",
                "16547485850637761685",
                "0",
                "0",
                "0",
            ],
            issuerAuthClaimMtp: [
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
            ],
            issuerAuthClaimNonRevMtp: [
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
            ],
            issuerAuthClaimNonRevMtpAuxHi: "0",
            issuerAuthClaimNonRevMtpAuxHv: "0",
            issuerAuthClaimNonRevMtpNoAux: "1",
            issuerAuthClaimsTreeRoot: "16935233905999379395228879484629933212061337894505747058350106225580401780334",
            issuerAuthRevTreeRoot: "0",
            issuerAuthRootsTreeRoot: "0",
            claimPathNotExists: "0",
            claimPathMtp: [
                "5559250731000753554753485016695600829384855452867544273344893815961938985436",
                "20222899544143787877985297439625828822272100269106711904511119118819809140477",
                "14730426618666280941604039095550905490156541514901979358549599762282042588641",
                "20497288520738821800886677250569208588689763166335933087499619993954968899866",
                "3295720551404287572425718873751040314503774617833462052445584373469655789999",
                "796356776410152646380783209242693344675665178494017735650545708722024766291",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
            ],
            claimPathMtpNoAux: "0",
            claimPathMtpAuxHi: "0",
            claimPathMtpAuxHv: "0",
            claimPathKey: "8566939875427719562376598811066985304309117528846759529734201066483458512800",
            claimPathValue: "1420070400000000000",
            operator: 1,
            slotIndex: 2,
            timestamp: "1642074362",
            value: [
                "1420070400000000000",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
                "0",
            ],
        }

        const expOut = {
            userID: "24357338057394103910029868244681596615276666879950910837900400354886746113",
            issuerID: "24357338057394103910029868244681596615276666879950910837900400354886746113",
            issuerAuthState: "18038855432424775233659896904370825175764119936950028950189276486279006981491",
            issuerClaimNonRevState: "18038855432424775233659896904370825175764119936950028950189276486279006981491",
            claimSchema: "180410020913331409885634153623124536270",
            slotIndex: "2",
            operator: "1",
            value: ["1420070400000000000", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"],
            timestamp: "1642074362",
        }
        const w = await circuit.calculateWitness(inputs, true);
        await circuit.checkConstraints(w);
        await circuit.assertOut(w, expOut);
    });

    it("Should check the circuit with valid inputs", async () => {
        const inOut = {
            inputs: {
                userGenesisID: "24357338057394103910029868244681596615276666879950910837900400354886746113",
                nonce: "0",
                claimSubjectProfileNonce: "0",
                issuerID: "24357338057394103910029868244681596615276666879950910837900400354886746113",
                issuerClaim: [
                    "3583233690122716044519380227940806650830",
                    "24357338057394103910029868244681596615276666879950910837900400354886746113",
                    "17568057213828477233507447080689055308823020388972334380526849356111335110900",
                    "0",
                    "30803922965249841627828060170",
                    "0",
                    "0",
                    "0",
                ],
                issuerClaimNonRevClaimsTreeRoot: "16935233905999379395228879484629933212061337894505747058350106225580401780334",
                issuerClaimNonRevRevTreeRoot: "0",
                issuerClaimNonRevRootsTreeRoot: "0",
                issuerClaimNonRevState: "18038855432424775233659896904370825175764119936950028950189276486279006981491",
                issuerClaimNonRevMtp: [
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                ],
                issuerClaimNonRevMtpAuxHi: "0",
                issuerClaimNonRevMtpAuxHv: "0",
                issuerClaimNonRevMtpNoAux: "1",
                claimSchema: "180410020913331409885634153623124536270",
                issuerClaimSignatureR8x: "3017397964988671065300729044646157787094963425063948585835659398590899755539",
                issuerClaimSignatureR8y: "8933147283525203493792096378411252775992322346613402903323345179819059106328",
                issuerClaimSignatureS: "2328449226267223092529649688730159507357166811782711131160124115135840509586",
                issuerAuthClaim: [
                    "304427537360709784173770334266246861770",
                    "0",
                    "4720763745722683616702324599137259461509439547324750011830105416383780791263",
                    "4844030361230692908091131578688419341633213823133966379083981236400104720538",
                    "16547485850637761685",
                    "0",
                    "0",
                    "0",
                ],
                issuerAuthClaimMtp: [
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                ],
                issuerAuthClaimNonRevMtp: [
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                ],
                issuerAuthClaimNonRevMtpAuxHi: "0",
                issuerAuthClaimNonRevMtpAuxHv: "0",
                issuerAuthClaimNonRevMtpNoAux: "1",
                issuerAuthClaimsTreeRoot: "16935233905999379395228879484629933212061337894505747058350106225580401780334",
                issuerAuthRevTreeRoot: "0",
                issuerAuthRootsTreeRoot: "0",
                claimPathNotExists: "0",
                claimPathMtp: [
                    "5559250731000753554753485016695600829384855452867544273344893815961938985436",
                    "20222899544143787877985297439625828822272100269106711904511119118819809140477",
                    "14730426618666280941604039095550905490156541514901979358549599762282042588641",
                    "20497288520738821800886677250569208588689763166335933087499619993954968899866",
                    "3295720551404287572425718873751040314503774617833462052445584373469655789999",
                    "796356776410152646380783209242693344675665178494017735650545708722024766291",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                ],
                claimPathMtpNoAux: "0",
                claimPathMtpAuxHi: "0",
                claimPathMtpAuxHv: "0",
                claimPathKey: "8566939875427719562376598811066985304309117528846759529734201066483458512800",
                claimPathValue: "1420070400000000000",
                operator: 1,
                slotIndex: 2,
                timestamp: "1642074362",
                value: [
                    "1420070400000000000",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                ],
            },
            expOut: {
                userID: "24357338057394103910029868244681596615276666879950910837900400354886746113",
                issuerID: "24357338057394103910029868244681596615276666879950910837900400354886746113",
                issuerAuthState: "18038855432424775233659896904370825175764119936950028950189276486279006981491",
                issuerClaimNonRevState: "18038855432424775233659896904370825175764119936950028950189276486279006981491",
                claimSchema: "180410020913331409885634153623124536270",
                slotIndex: "2",
                operator: "1",
                value: [
                    "1420070400000000000",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                    "0",
                ],
                timestamp: "1642074362",
            },
        }
        const w = await circuit.calculateWitness(inOut.inputs, true);
        await circuit.checkConstraints(w);
        await circuit.assertOut(w, inOut.expOut);
    });

    it("Should verify UserID is genesis ID, claim issued on Profile (nonce 10)", async () => {
        const inOut = {inputs: {userGenesisID: "24357338057394103910029868244681596615276666879950910837900400354886746113", nonce: "0", claimSubjectProfileNonce: "10", issuerID: "24357338057394103910029868244681596615276666879950910837900400354886746113", issuerClaim: ["3583233690122716044519380227940806650830", "16501380676610282756331962130170908325950918404081458092270009074630918145", "17568057213828477233507447080689055308823020388972334380526849356111335110900", "0", "30803922965249841627828060170", "0", "0", "0"], issuerClaimNonRevClaimsTreeRoot: "16935233905999379395228879484629933212061337894505747058350106225580401780334", issuerClaimNonRevRevTreeRoot: "0", issuerClaimNonRevRootsTreeRoot: "0", issuerClaimNonRevState: "18038855432424775233659896904370825175764119936950028950189276486279006981491", issuerClaimNonRevMtp: ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], issuerClaimNonRevMtpAuxHi: "0", issuerClaimNonRevMtpAuxHv: "0", issuerClaimNonRevMtpNoAux: "1", claimSchema: "180410020913331409885634153623124536270", issuerClaimSignatureR8x: "9954147404641128970677345221231279072596559158843386129370741564373237497384", issuerClaimSignatureR8y: "8056123060775311000731022190682909927067284622050929954947775540273362580200", issuerClaimSignatureS: "629630392940433506400041503110244019044785633762967107995794433726139295123", issuerAuthClaim: ["304427537360709784173770334266246861770", "0", "4720763745722683616702324599137259461509439547324750011830105416383780791263", "4844030361230692908091131578688419341633213823133966379083981236400104720538", "16547485850637761685", "0", "0", "0"], issuerAuthClaimMtp: ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], issuerAuthClaimNonRevMtp: ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], issuerAuthClaimNonRevMtpAuxHi: "0", issuerAuthClaimNonRevMtpAuxHv: "0", issuerAuthClaimNonRevMtpNoAux: "1", issuerAuthClaimsTreeRoot: "16935233905999379395228879484629933212061337894505747058350106225580401780334", issuerAuthRevTreeRoot: "0", issuerAuthRootsTreeRoot: "0", claimPathNotExists: "0", claimPathMtp: ["5559250731000753554753485016695600829384855452867544273344893815961938985436", "20222899544143787877985297439625828822272100269106711904511119118819809140477", "14730426618666280941604039095550905490156541514901979358549599762282042588641", "20497288520738821800886677250569208588689763166335933087499619993954968899866", "3295720551404287572425718873751040314503774617833462052445584373469655789999", "796356776410152646380783209242693344675665178494017735650545708722024766291", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], claimPathMtpNoAux: "0", claimPathMtpAuxHi: "0", claimPathMtpAuxHv: "0", claimPathKey: "8566939875427719562376598811066985304309117528846759529734201066483458512800", claimPathValue: "1420070400000000000", operator: 1, slotIndex: 2, timestamp: "1642074362", value: ["1420070400000000000", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"]}, expOut: {userID: "24357338057394103910029868244681596615276666879950910837900400354886746113", issuerID: "24357338057394103910029868244681596615276666879950910837900400354886746113", issuerAuthState: "18038855432424775233659896904370825175764119936950028950189276486279006981491", issuerClaimNonRevState: "18038855432424775233659896904370825175764119936950028950189276486279006981491", claimSchema: "180410020913331409885634153623124536270", slotIndex: "2", operator: 1, value: ["1420070400000000000", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], timestamp: "1642074362"}}
        const w = await circuit.calculateWitness(inOut.inputs, true);
        await circuit.checkConstraints(w);
        await circuit.assertOut(w, inOut.expOut);
    });

    it("Should verify UserID is Profile ID, claim issued on Profile (nonce 10)", async () => {
        const inOut = {inputs: {userGenesisID: "24357338057394103910029868244681596615276666879950910837900400354886746113", nonce: "10", claimSubjectProfileNonce: "10", issuerID: "24357338057394103910029868244681596615276666879950910837900400354886746113", issuerClaim: ["3583233690122716044519380227940806650830", "16501380676610282756331962130170908325950918404081458092270009074630918145", "17568057213828477233507447080689055308823020388972334380526849356111335110900", "0", "30803922965249841627828060170", "0", "0", "0"], issuerClaimNonRevClaimsTreeRoot: "16935233905999379395228879484629933212061337894505747058350106225580401780334", issuerClaimNonRevRevTreeRoot: "0", issuerClaimNonRevRootsTreeRoot: "0", issuerClaimNonRevState: "18038855432424775233659896904370825175764119936950028950189276486279006981491", issuerClaimNonRevMtp: ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], issuerClaimNonRevMtpAuxHi: "0", issuerClaimNonRevMtpAuxHv: "0", issuerClaimNonRevMtpNoAux: "1", claimSchema: "180410020913331409885634153623124536270", issuerClaimSignatureR8x: "9954147404641128970677345221231279072596559158843386129370741564373237497384", issuerClaimSignatureR8y: "8056123060775311000731022190682909927067284622050929954947775540273362580200", issuerClaimSignatureS: "629630392940433506400041503110244019044785633762967107995794433726139295123", issuerAuthClaim: ["304427537360709784173770334266246861770", "0", "4720763745722683616702324599137259461509439547324750011830105416383780791263", "4844030361230692908091131578688419341633213823133966379083981236400104720538", "16547485850637761685", "0", "0", "0"], issuerAuthClaimMtp: ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], issuerAuthClaimNonRevMtp: ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], issuerAuthClaimNonRevMtpAuxHi: "0", issuerAuthClaimNonRevMtpAuxHv: "0", issuerAuthClaimNonRevMtpNoAux: "1", issuerAuthClaimsTreeRoot: "16935233905999379395228879484629933212061337894505747058350106225580401780334", issuerAuthRevTreeRoot: "0", issuerAuthRootsTreeRoot: "0", claimPathNotExists: "0", claimPathMtp: ["5559250731000753554753485016695600829384855452867544273344893815961938985436", "20222899544143787877985297439625828822272100269106711904511119118819809140477", "14730426618666280941604039095550905490156541514901979358549599762282042588641", "20497288520738821800886677250569208588689763166335933087499619993954968899866", "3295720551404287572425718873751040314503774617833462052445584373469655789999", "796356776410152646380783209242693344675665178494017735650545708722024766291", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], claimPathMtpNoAux: "0", claimPathMtpAuxHi: "0", claimPathMtpAuxHv: "0", claimPathKey: "8566939875427719562376598811066985304309117528846759529734201066483458512800", claimPathValue: "1420070400000000000", operator: 1, slotIndex: 2, timestamp: "1642074362", value: ["1420070400000000000", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"]}, expOut: {userID: "16501380676610282756331962130170908325950918404081458092270009074630918145", issuerID: "24357338057394103910029868244681596615276666879950910837900400354886746113", issuerAuthState: "18038855432424775233659896904370825175764119936950028950189276486279006981491", issuerClaimNonRevState: "18038855432424775233659896904370825175764119936950028950189276486279006981491", claimSchema: "180410020913331409885634153623124536270", slotIndex: "2", operator: 1, value: ["1420070400000000000", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], timestamp: "1642074362"}}
        const w = await circuit.calculateWitness(inOut.inputs, true);
        await circuit.checkConstraints(w);
        await circuit.assertOut(w, inOut.expOut);
    });

    it("Should verify UserID is Profile ID(nonce = 999), claim issued on Profile (nonce 10)", async () => {
        const inOut = {inputs: {userGenesisID: "24357338057394103910029868244681596615276666879950910837900400354886746113", nonce: "999", claimSubjectProfileNonce: "10", issuerID: "24357338057394103910029868244681596615276666879950910837900400354886746113", issuerClaim: ["3583233690122716044519380227940806650830", "16501380676610282756331962130170908325950918404081458092270009074630918145", "17568057213828477233507447080689055308823020388972334380526849356111335110900", "0", "30803922965249841627828060170", "0", "0", "0"], issuerClaimNonRevClaimsTreeRoot: "16935233905999379395228879484629933212061337894505747058350106225580401780334", issuerClaimNonRevRevTreeRoot: "0", issuerClaimNonRevRootsTreeRoot: "0", issuerClaimNonRevState: "18038855432424775233659896904370825175764119936950028950189276486279006981491", issuerClaimNonRevMtp: ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], issuerClaimNonRevMtpAuxHi: "0", issuerClaimNonRevMtpAuxHv: "0", issuerClaimNonRevMtpNoAux: "1", claimSchema: "180410020913331409885634153623124536270", issuerClaimSignatureR8x: "9954147404641128970677345221231279072596559158843386129370741564373237497384", issuerClaimSignatureR8y: "8056123060775311000731022190682909927067284622050929954947775540273362580200", issuerClaimSignatureS: "629630392940433506400041503110244019044785633762967107995794433726139295123", issuerAuthClaim: ["304427537360709784173770334266246861770", "0", "4720763745722683616702324599137259461509439547324750011830105416383780791263", "4844030361230692908091131578688419341633213823133966379083981236400104720538", "16547485850637761685", "0", "0", "0"], issuerAuthClaimMtp: ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], issuerAuthClaimNonRevMtp: ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], issuerAuthClaimNonRevMtpAuxHi: "0", issuerAuthClaimNonRevMtpAuxHv: "0", issuerAuthClaimNonRevMtpNoAux: "1", issuerAuthClaimsTreeRoot: "16935233905999379395228879484629933212061337894505747058350106225580401780334", issuerAuthRevTreeRoot: "0", issuerAuthRootsTreeRoot: "0", claimPathNotExists: "0", claimPathMtp: ["5559250731000753554753485016695600829384855452867544273344893815961938985436", "20222899544143787877985297439625828822272100269106711904511119118819809140477", "14730426618666280941604039095550905490156541514901979358549599762282042588641", "20497288520738821800886677250569208588689763166335933087499619993954968899866", "3295720551404287572425718873751040314503774617833462052445584373469655789999", "796356776410152646380783209242693344675665178494017735650545708722024766291", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], claimPathMtpNoAux: "0", claimPathMtpAuxHi: "0", claimPathMtpAuxHv: "0", claimPathKey: "8566939875427719562376598811066985304309117528846759529734201066483458512800", claimPathValue: "1420070400000000000", operator: 1, slotIndex: 2, timestamp: "1642074362", value: ["1420070400000000000", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"]}, expOut: {userID: "19933278588808080426688072751524960199355164583837691837234531701178368001", issuerID: "24357338057394103910029868244681596615276666879950910837900400354886746113", issuerAuthState: "18038855432424775233659896904370825175764119936950028950189276486279006981491", issuerClaimNonRevState: "18038855432424775233659896904370825175764119936950028950189276486279006981491", claimSchema: "180410020913331409885634153623124536270", slotIndex: "2", operator: 1, value: ["1420070400000000000", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"], timestamp: "1642074362"}}
        const w = await circuit.calculateWitness(inOut.inputs, true);
        await circuit.checkConstraints(w);
        await circuit.assertOut(w, inOut.expOut);
    });

});
